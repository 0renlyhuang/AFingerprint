# Audio Fingerprint Visualization

This directory contains the visualization tools for the audio fingerprinting system.

## Files

- `visualize_fingerprints.py` - Python script to generate interactive visualizations with audio playback

## Usage

For interactive visualizations with hover information:

```bash
# For fingerprint extraction visualization
python3 visualize_fingerprints.py --source path/to/fingerprint.json

# For query audio visualization
python3 visualize_fingerprints.py --query path/to/query.json

# For comparison visualization
python3 visualize_fingerprints.py --source path/to/source.json --query path/to/query.json --sessions path/to/sessions.json
```

To add audio playback functionality:

```bash
# For fingerprint extraction visualization with audio
python3 visualize_fingerprints.py --source path/to/fingerprint.json --source-audio path/to/audio.wav

# For query audio visualization with audio
python3 visualize_fingerprints.py --query path/to/query.json --query-audio path/to/audio.wav
```

To generate static PNG files:

```bash
# For fingerprint extraction visualization
python3 visualize_fingerprints.py --source path/to/fingerprint.json --output output.png

# For query audio visualization
python3 visualize_fingerprints.py --query path/to/query.json --output output.png

# For comparison visualization
python3 visualize_fingerprints.py --source path/to/source.json --query path/to/query.json --sessions path/to/sessions.json --output output.png
```

## Embedded Audio File Paths

The visualization system now supports embedding audio file paths directly in the JSON data files:

1. The C++ code includes the path to the audio file (PCM/WAV/MP3) in the generated JSON
2. The visualization script automatically detects and uses these embedded paths
3. Command-line audio paths (--source-audio, --query-audio) will override embedded paths if provided

Example of JSON format with embedded audio path:

```json
{
  "title": "Audio Sample",
  "duration": 30.5,
  "audioFilePath": "/path/to/audio.wav",
  "allPeaks": [
    ...
  ]
}
```

## Requirements

- Python 3.x
- matplotlib
- numpy
- For audio playback:
  - soundfile
  - sounddevice

Install audio playback dependencies:

```bash
pip install soundfile sounddevice
```

## Audio Playback

The audio playback feature allows you to:

1. Visualize fingerprint points while listening to the corresponding audio
2. Click anywhere on the spectrogram to jump to that position in the audio
3. Use the play/stop buttons and time slider to control playback
4. See which audio segments correspond to specific fingerprint points

This helps in understanding which audio features are being selected as fingerprints by the algorithm.

## Integration with C++ Code

The C++ code generates JSON files with the following naming convention:
- `*_fingerprint.json` - Extraction visualization data
- `*_query.json` - Query audio matching data
- `*_source.json` - Source audio matching data
- `*_sessions.json` - Top matching sessions data

These files contain all the necessary information for visualization. The visualization script does not rely on any Python code generated by the C++ program, making it easier to maintain and update. 